\begin{algorithm}[H]
    \caption{\label{alg.nipopow-infix-prover}The \textsf{Prove} algorithm
    for infix proofs}
    \begin{algorithmic}[1]
        \Function{\sf ProveInfix$_{m,k}$}{$\chain$, $\chain'$, \textsf{height}} % , realLink, blockById}
            \Let{aux}{\emptyset}
            \Let{(\pi, \chi)}{\textsf{Prove}_{m,k}(\chain)}
            \Comment{Start with a suffix proof}
            \For{$B \in \chain'$}
                \For{$E \in \pi$}
                    \If{$\textsf{height}[E] \geq \textsf{height}[B]$}
                        %, \textsf{realLink}, \textsf{blockById})}
                        \ifonecolumn
                            \Let{aux}{aux \cup \textsf{followDown}(E, B, \textsf{height})}
                        \else
                            \State \begin{varwidth}[t]{\linewidth}
                                $L \gets \textsf{followUp}(B, \emph{level}(E'),$\par
                                \hskip\algorithmicindent \hskip\algorithmicindent
                                \hskip\algorithmicindent \hskip\algorithmicindent
                                $\textsf{realLink}, \textsf{blockById})$
                            \end{varwidth}
                            \Let{aux}{aux \cup L}
                        \fi
                        \State\textbf{break}
                    \EndIf
                \EndFor
            \EndFor
            \State\Return{$(aux \cup \pi, \chi)$}
        \EndFunction
    \vskip2pt
    \end{algorithmic}
\end{algorithm}
